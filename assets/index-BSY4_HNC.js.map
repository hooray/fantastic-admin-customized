{"version":3,"file":"index-BSY4_HNC.js","sources":["../../src/layouts/components/SubSidebar/index.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport useMenuStore from '@/store/modules/menu'\nimport useSettingsStore from '@/store/modules/settings'\nimport { useElementSize } from '@vueuse/core'\nimport Logo from '../Logo/index.vue'\nimport Menu from '../Menu/index.vue'\n\ndefineOptions({\n  name: 'SubSidebar',\n})\n\nconst route = useRoute()\n\nconst settingsStore = useSettingsStore()\nconst menuStore = useMenuStore()\n\nconst subSidebarRef = useTemplateRef('subSidebarRef')\nconst showShadowTop = ref(false)\nconst showShadowBottom = ref(false)\nfunction onSidebarScroll() {\n  const scrollTop = subSidebarRef.value?.scrollTop ?? 0\n  showShadowTop.value = scrollTop > 0\n  const clientHeight = subSidebarRef.value?.clientHeight ?? 0\n  const scrollHeight = subSidebarRef.value?.scrollHeight ?? 0\n  showShadowBottom.value = Math.ceil(scrollTop + clientHeight) < scrollHeight\n}\n\nconst enableSidebar = computed(() => {\n  return settingsStore.mode === 'mobile' || (\n    ['side', 'head', 'single'].includes(settingsStore.settings.menu.mode)\n    && menuStore.sidebarMenus.length !== 0\n    && !menuStore.sidebarMenus.every(item => item.meta?.menu === false)\n  ) || (\n    settingsStore.settings.menu.mode === 'customized'\n    && menuStore.sidebarMenus[menuStore.subActived]?.children?.length !== 0\n    && !menuStore.sidebarMenus[menuStore.subActived]?.children?.every(item => item.meta?.menu === false)\n  )\n})\n\nwatch(enableSidebar, (val) => {\n  if (val) {\n    nextTick(() => {\n      onSidebarScroll()\n    })\n  }\n}, {\n  immediate: true,\n})\n\nconst menuRef = useTemplateRef('menuRef')\n\nonMounted(() => {\n  if (enableSidebar.value) {\n    const { height } = useElementSize(menuRef)\n    watch(() => height.value, () => {\n      if (height.value > 0) {\n        onSidebarScroll()\n      }\n    }, {\n      immediate: true,\n    })\n  }\n})\n\nconst isCollapse = computed(() => {\n  if (settingsStore.mode === 'pc') {\n    if (settingsStore.settings.menu.subMenuCollapse && (!settingsStore.isHoverSidebar || (settingsStore.isHoverSidebar && !settingsStore.settings.menu.subMenuAutoCollapse))) {\n      return true\n    }\n    else {\n      return false\n    }\n  }\n  return settingsStore.settings.menu.subMenuCollapse\n})\n</script>\n\n<template>\n  <div\n    v-if=\"enableSidebar\" class=\"sub-sidebar-container\" :class=\"{\n      'is-collapse': isCollapse,\n      'shadow-side': settingsStore.isHoverSidebar && settingsStore.settings.menu.subMenuAutoCollapse && settingsStore.settings.menu.subMenuCollapse,\n    }\"\n  >\n    <Logo\n      :show-logo=\"settingsStore.settings.menu.mode === 'single'\" class=\"sidebar-logo\" :class=\"{\n        'sidebar-logo-bg': settingsStore.settings.menu.mode === 'single',\n      }\"\n    />\n    <div\n      ref=\"subSidebarRef\" class=\"sub-sidebar flex-1 transition-shadow-300 scrollbar-none\" :class=\"{\n        'shadow-top': showShadowTop,\n        'shadow-bottom': showShadowBottom,\n      }\" @scroll=\"onSidebarScroll\"\n    >\n      <div ref=\"menuRef\">\n        <TransitionGroup v-if=\"settingsStore.settings.menu.mode === 'customized'\" name=\"sub-sidebar\">\n          <template v-for=\"(mainItem, mainIndex) in menuStore.allMenus[menuStore.actived].children\" :key=\"mainIndex\">\n            <div v-show=\"mainIndex === menuStore.subActived\">\n              <Menu\n                v-if=\"mainItem.children\" :menu=\"mainItem.children\" :value=\"route.meta.activeMenu || route.path\" :default-openeds=\"menuStore.defaultOpenedPaths\" :always-openeds=\"menuStore.alwaysOpenedPaths\" :accordion=\"settingsStore.settings.menu.subMenuUniqueOpened\" :collapse=\"isCollapse\" :rounded=\"settingsStore.settings.menu.isRounded\" :direction=\"settingsStore.settings.app.direction\" class=\"menu\"\n              />\n            </div>\n          </template>\n        </TransitionGroup>\n        <TransitionGroup v-else name=\"sub-sidebar\">\n          <template v-for=\"(mainItem, mainIndex) in menuStore.allMenus\" :key=\"mainIndex\">\n            <div v-show=\"mainIndex === menuStore.actived\">\n              <Menu\n                v-if=\"mainItem.children\" :menu=\"mainItem.children\" :value=\"route.meta.activeMenu || route.path\" :default-openeds=\"menuStore.defaultOpenedPaths\" :always-openeds=\"menuStore.alwaysOpenedPaths\" :accordion=\"settingsStore.settings.menu.subMenuUniqueOpened\" :collapse=\"isCollapse\" :rounded=\"settingsStore.settings.menu.isRounded\" :direction=\"settingsStore.settings.app.direction\" class=\"menu\" :class=\"{\n                  '-mt-2': !(isCollapse || ['head', 'single', 'customized'].includes(settingsStore.settings.menu.mode)),\n                }\"\n              />\n            </div>\n          </template>\n        </TransitionGroup>\n      </div>\n    </div>\n    <div\n      v-if=\"settingsStore.mode === 'pc' && settingsStore.settings.menu.enableSubMenuCollapseButton\" class=\"relative flex items-center px-4 py-3\" :class=\"{\n        'justify-center': isCollapse,\n        'justify-between': !isCollapse,\n      }\"\n    >\n      <span v-show=\"!isCollapse\" class=\"flex-center cursor-pointer rounded bg-stone-1 p-2 transition dark-bg-stone-9 hover-bg-stone-2 dark-hover-bg-stone-8\" @click=\"settingsStore.toggleSidebarAutoCollapse()\">\n        <SvgIcon :name=\"settingsStore.settings.menu.subMenuAutoCollapse ? 'i-lucide:pin-off' : 'i-lucide:pin'\" />\n      </span>\n      <span class=\"flex-center cursor-pointer rounded bg-stone-1 p-2 transition dark-bg-stone-9 hover-bg-stone-2 dark-hover-bg-stone-8\" :class=\"{ '-rotate-z-180': settingsStore.settings.menu.subMenuCollapse }\" @click=\"settingsStore.toggleSidebarCollapse()\">\n        <SvgIcon name=\"toolbar-collapse\" />\n      </span>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.sub-sidebar-container {\n  position: absolute;\n  inset-inline-start: 0;\n  top: var(--g-sub-main-sidebar-actual-height);\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  width: var(--g-sub-sidebar-width);\n  background-color: var(--g-sub-sidebar-bg);\n  box-shadow: -1px 0 0 0 var(--g-border-color), 1px 0 0 0 var(--g-border-color);\n  transition: background-color 0.3s, inset-inline-start 0.3s, width 0.3s, box-shadow 0.3s;\n\n  &.is-collapse {\n    width: var(--g-sub-sidebar-collapse-width);\n\n    .sidebar-logo {\n      &:not(.sidebar-logo-bg) {\n        display: none;\n      }\n\n      :deep(span) {\n        display: none;\n      }\n    }\n  }\n\n  &.shadow-side {\n    box-shadow: 10px 0 10px -10px var(--g-box-shadow-color);\n  }\n\n  .sidebar-logo {\n    background-color: var(--g-sub-sidebar-bg);\n    transition: background-color 0.3s;\n\n    &.sidebar-logo-bg {\n      background-color: var(--g-sub-sidebar-logo-bg);\n\n      :deep(span) {\n        color: var(--g-sub-sidebar-logo-color);\n      }\n    }\n  }\n\n  .sub-sidebar {\n    overflow: hidden auto;\n    overscroll-behavior: contain;\n\n    &.shadow-top {\n      box-shadow: inset 0 10px 10px -10px var(--g-box-shadow-color), inset 0 0 0 transparent;\n    }\n\n    &.shadow-bottom {\n      box-shadow: inset 0 0 0 transparent, inset 0 -10px 10px -10px var(--g-box-shadow-color);\n    }\n\n    &.shadow-top.shadow-bottom {\n      box-shadow: inset 0 10px 10px -10px var(--g-box-shadow-color), inset 0 -10px 10px -10px var(--g-box-shadow-color);\n    }\n  }\n\n  .menu {\n    width: 100%;\n  }\n}\n\n/* 次侧边栏动画 */\n.sub-sidebar-enter-active {\n  transition: 0.2s;\n}\n\n.sub-sidebar-enter-from,\n.sub-sidebar-leave-active {\n  opacity: 0;\n  transform: translateY(30px) skewY(10deg);\n}\n\n.sub-sidebar-leave-active {\n  position: absolute;\n}\n</style>\n"],"names":["route","useRoute","settingsStore","useSettingsStore","menuStore","useMenuStore","subSidebarRef","useTemplateRef","showShadowTop","ref","showShadowBottom","onSidebarScroll","scrollTop","_a","clientHeight","_b","scrollHeight","_c","enableSidebar","computed","item","_d","watch","val","nextTick","menuRef","onMounted","height","useElementSize","isCollapse"],"mappings":"ssBAWA,MAAMA,EAAQC,IAERC,EAAgBC,IAChBC,EAAYC,IAEZC,EAAgBC,EAAe,eAAe,EAC9CC,EAAgBC,EAAI,EAAK,EACzBC,EAAmBD,EAAI,EAAK,EAClC,SAASE,GAAkB,WACnB,MAAAC,IAAYC,EAAAP,EAAc,QAAd,YAAAO,EAAqB,YAAa,EACpDL,EAAc,MAAQI,EAAY,EAC5B,MAAAE,IAAeC,EAAAT,EAAc,QAAd,YAAAS,EAAqB,eAAgB,EACpDC,IAAeC,EAAAX,EAAc,QAAd,YAAAW,EAAqB,eAAgB,EAC1DP,EAAiB,MAAQ,KAAK,KAAKE,EAAYE,CAAY,EAAIE,CACjE,CAEM,MAAAE,EAAgBC,EAAS,IAAM,aAC5B,OAAAjB,EAAc,OAAS,UAC5B,CAAC,OAAQ,OAAQ,QAAQ,EAAE,SAASA,EAAc,SAAS,KAAK,IAAI,GACjEE,EAAU,aAAa,SAAW,GAClC,CAACA,EAAU,aAAa,MAAcgB,GAAA,OAAA,QAAAP,EAAAO,EAAK,OAAL,YAAAP,EAAW,QAAS,GAAK,GAElEX,EAAc,SAAS,KAAK,OAAS,gBAClCa,GAAAF,EAAAT,EAAU,aAAaA,EAAU,UAAU,IAA3C,YAAAS,EAA8C,WAA9C,YAAAE,EAAwD,UAAW,GACnE,GAACM,GAAAJ,EAAAb,EAAU,aAAaA,EAAU,UAAU,IAA3C,YAAAa,EAA8C,WAA9C,MAAAI,EAAwD,MAAcD,GAAA,OAAA,QAAAP,EAAAO,EAAK,OAAL,YAAAP,EAAW,QAAS,KAAK,CAEtG,EAEKS,EAAAJ,EAAgBK,GAAQ,CACxBA,GACFC,EAAS,IAAM,CACGb,GAAA,CACjB,CACH,EACC,CACD,UAAW,EAAA,CACZ,EAEK,MAAAc,EAAUlB,EAAe,SAAS,EAExCmB,EAAU,IAAM,CACd,GAAIR,EAAc,MAAO,CACvB,KAAM,CAAE,OAAAS,CAAA,EAAWC,EAAeH,CAAO,EACnCH,EAAA,IAAMK,EAAO,MAAO,IAAM,CAC1BA,EAAO,MAAQ,GACDhB,GAClB,EACC,CACD,UAAW,EAAA,CACZ,CACH,CAAA,CACD,EAEK,MAAAkB,EAAaV,EAAS,IACtBjB,EAAc,OAAS,KACrB,GAAAA,EAAc,SAAS,KAAK,kBAAoB,CAACA,EAAc,gBAAmBA,EAAc,gBAAkB,CAACA,EAAc,SAAS,KAAK,sBAO9IA,EAAc,SAAS,KAAK,eACpC"}