{"version":3,"file":"item-CiDAJ3Wj.js","sources":["../../src/layouts/components/Menu/types.ts","../../src/layouts/components/Menu/item.vue"],"sourcesContent":["import type { Menu } from '#/global'\n\nexport interface MenuItem {\n  index: string\n  indexPath: string[]\n  active?: boolean\n}\n\nexport interface MenuProps {\n  menu: Menu.recordRaw[]\n  value: string\n  accordion?: boolean\n  defaultOpeneds?: string[]\n  alwaysOpeneds?: string[]\n  mode?: 'horizontal' | 'vertical'\n  collapse?: boolean\n  showCollapseName?: boolean\n  rounded?: boolean\n  direction?: 'ltr' | 'rtl'\n}\n\nexport interface MenuInjection {\n  props: MenuProps\n  items: Record<string, MenuItem>\n  subMenus: Record<string, MenuItem>\n  activeIndex: MenuProps['value']\n  openedMenus: string[]\n  alwaysOpenedsMenus: string[]\n  mouseInMenu: string[]\n  isMenuPopup: boolean\n  openMenu: (index: string, indexPath: string[]) => void\n  closeMenu: (index: string | string[]) => void\n  handleMenuItemClick: (index: string) => void\n  handleSubMenuClick: (index: string, indexPath: string[]) => void\n}\n\nexport const rootMenuInjectionKey = Symbol('rootMenu') as InjectionKey<MenuInjection>\n\nexport interface SubMenuProps {\n  uniqueKey: string[]\n  menu: Menu.recordRaw\n  level?: number\n}\n\nexport interface SubMenuItemProps {\n  uniqueKey: string[]\n  item: Menu.recordRaw\n  level?: number\n  subMenu?: boolean\n  expand?: boolean\n  alwaysExpand?: boolean\n}\n","<script setup lang=\"ts\">\nimport type { SubMenuItemProps } from './types'\nimport { rootMenuInjectionKey } from './types'\n\ndefineOptions({\n  name: 'SubMenuItem',\n})\n\nconst props = withDefaults(\n  defineProps<SubMenuItemProps>(),\n  {\n    level: 0,\n    subMenu: false,\n    expand: false,\n    alwaysExpand: false,\n  },\n)\n\nconst { generateI18nTitle } = useMenu()\n\nconst rootMenu = inject(rootMenuInjectionKey)!\n\nconst itemRef = ref<HTMLElement>()\n\nconst isActived = computed(() => {\n  return props.subMenu\n    ? rootMenu.subMenus[props.uniqueKey.at(-1)!].active\n    : rootMenu.activeIndex === props.uniqueKey.at(-1)!\n})\n\nconst isItemActive = computed(() => {\n  return isActived.value && (!props.subMenu || rootMenu.isMenuPopup)\n})\n\nconst icon = computed(() => {\n  let icon\n  if (props.item.meta?.icon) {\n    icon = props.item.meta.icon\n  }\n  if (isActived.value) {\n    if (props.item.meta?.activeIcon) {\n      icon = props.item.meta.activeIcon\n    }\n  }\n  return icon\n})\n\n// 缩进样式\nconst indentStyle = computed(() => {\n  return !rootMenu.isMenuPopup\n    ? `padding-inline-start: ${20 * (props.level ?? 0)}px`\n    : ''\n})\n\ndefineExpose({\n  ref: itemRef,\n})\n</script>\n\n<template>\n  <div\n    ref=\"itemRef\" class=\"menu-item relative transition-all\" :class=\"{\n      'active': isItemActive,\n      'py-1 px-2': (rootMenu.isMenuPopup && rootMenu.props.mode === 'vertical') || (rootMenu.isMenuPopup && level !== 0 && rootMenu.props.mode === 'horizontal') || !rootMenu.isMenuPopup,\n      'px-1 py-2': rootMenu.isMenuPopup && level === 0 && rootMenu.props.mode === 'horizontal',\n    }\"\n  >\n    <router-link v-slot=\"{ href, navigate }\" custom :to=\"uniqueKey.at(-1) ?? ''\">\n      <HTooltip :enable=\"rootMenu.isMenuPopup && level === 0 && !subMenu\" :text=\"generateI18nTitle(item.meta?.title)\" :placement=\"rootMenu.props.mode === 'vertical' ? 'right' : 'bottom'\" class=\"h-full w-full\">\n        <component\n          :is=\"subMenu ? 'div' : 'a'\" v-bind=\"{\n            ...(!subMenu && {\n              href: item.meta?.link ? item.meta.link : href,\n              target: item.meta?.newWindow || item.meta?.link ? '_blank' : '_self',\n              class: 'no-underline',\n            }),\n          }\" class=\"group menu-item-container h-full w-full flex items-center justify-between gap-1 px-4 py-3\" :class=\"{\n            ...(rootMenu.isMenuPopup || !alwaysExpand\n              ? {\n                'cursor-pointer text-[var(--g-sub-sidebar-menu-color)] transition-all hover-bg-[var(--g-sub-sidebar-menu-hover-bg)] hover-text-[var(--g-sub-sidebar-menu-hover-color)]': true,\n                'text-[var(--g-sub-sidebar-menu-active-color)]! bg-[var(--g-sub-sidebar-menu-active-bg)]!': isItemActive,\n                'rounded-lg': rootMenu.props.rounded,\n                'px-3!': rootMenu.isMenuPopup && level === 0,\n                'py-3!': rootMenu.props.rounded && rootMenu.isMenuPopup && level !== 0,\n              }\n              : {\n                'py-2! opacity-30': true,\n              }\n            ),\n          }\" :title=\"generateI18nTitle(item.meta?.title)\" v-on=\"{\n            ...(!subMenu && {\n              click: navigate,\n            }),\n          }\"\n        >\n          <div\n            class=\"inline-flex flex-1 items-center justify-center gap-[12px]\" :class=\"{\n              'flex-col': rootMenu.isMenuPopup && level === 0 && rootMenu.props.mode === 'vertical',\n              'gap-1!': rootMenu.isMenuPopup && level === 0 && rootMenu.props.showCollapseName,\n              'w-full': rootMenu.isMenuPopup && level === 0 && rootMenu.props.showCollapseName && rootMenu.props.mode === 'vertical',\n            }\" :style=\"indentStyle\"\n          >\n            <SvgIcon\n              v-if=\"icon\" :name=\"icon\" :size=\"18\" class=\"menu-item-container-icon\" :class=\"{\n                'transition-transform group-hover-scale-120': rootMenu.isMenuPopup || !alwaysExpand,\n              }\"\n            />\n            <span\n              v-if=\"!(rootMenu.isMenuPopup && level === 0 && !rootMenu.props.showCollapseName)\" class=\"w-0 flex-1 truncate text-sm transition-height transition-opacity transition-width\"\n              :class=\"{\n                'opacity-0 w-0 h-0': rootMenu.isMenuPopup && level === 0 && !rootMenu.props.showCollapseName,\n                'w-full text-center': rootMenu.isMenuPopup && level === 0 && rootMenu.props.showCollapseName,\n              }\"\n            >\n              {{ generateI18nTitle(item.meta?.title) }}\n            </span>\n            <HBadge v-if=\"item.meta?.badge && !(rootMenu.isMenuPopup && level === 0)\" :value=\"typeof item.meta.badge === 'function' ? item.meta.badge() : item.meta.badge\" class=\"badge\" />\n          </div>\n          <i\n            v-if=\"\n              subMenu\n                && (!rootMenu.isMenuPopup || level !== 0) // 非收起模式，非一级的子菜单\n                && (rootMenu.isMenuPopup || !alwaysExpand) // 收起模式，非始终展开的子菜单\n            \" class=\"relative ms-1 w-[10px] after:absolute after:h-[1.5px] after:w-[6px] after:bg-current after:transition-transform-200 after:content-empty after:-translate-y-[1px] before:absolute before:h-[1.5px] before:w-[6px] before:bg-current before:transition-transform-200 before:content-empty before:-translate-y-[1px]\" :class=\"[\n              expand ? 'before:-rotate-45 before:-translate-x-[2px] after:rotate-45 after:translate-x-[2px]' : 'before:rotate-45 before:-translate-x-[2px] after:-rotate-45 after:translate-x-[2px]',\n              rootMenu.isMenuPopup && level === 0 && 'opacity-0',\n              rootMenu.isMenuPopup && level !== 0 && '-rotate-90 -top-[1.5px]',\n            ]\"\n          />\n        </component>\n      </HTooltip>\n    </router-link>\n  </div>\n</template>\n\n<style scoped>\n.badge {\n  :deep(> span) {\n    inset-inline-start: initial !important;\n    inset-inline-end: 0;\n  }\n}\n</style>\n"],"names":["rootMenuInjectionKey","props","__props","generateI18nTitle","useMenu","rootMenu","inject","itemRef","ref","isActived","computed","isItemActive","icon","_a","_b","indentStyle","__expose"],"mappings":"qVAoCa,MAAAA,EAAuB,OAAO,UAAU,qNC5BrD,MAAMC,EAAQC,EAUR,CAAE,kBAAAC,GAAsBC,IAExBC,EAAWC,EAAON,CAAoB,EAEtCO,EAAUC,IAEVC,EAAYC,EAAS,IAClBT,EAAM,QACTI,EAAS,SAASJ,EAAM,UAAU,GAAG,EAAE,CAAE,EAAE,OAC3CI,EAAS,cAAgBJ,EAAM,UAAU,GAAG,EAAE,CACnD,EAEKU,EAAeD,EAAS,IACrBD,EAAU,QAAU,CAACR,EAAM,SAAWI,EAAS,YACvD,EAEKO,EAAOF,EAAS,IAAM,SACtBE,IAAAA,EACA,OAAAC,EAAAZ,EAAM,KAAK,OAAX,MAAAY,EAAiB,OACnBD,EAAOX,EAAM,KAAK,KAAK,MAErBQ,EAAU,QACRK,EAAAb,EAAM,KAAK,OAAX,MAAAa,EAAiB,aACnBF,EAAOX,EAAM,KAAK,KAAK,YAGpBW,CAAA,CACR,EAGKG,EAAcL,EAAS,IACnBL,EAAS,YAEb,GADA,yBAAyB,IAAMJ,EAAM,OAAS,EAAE,IAErD,EAEY,OAAAe,EAAA,CACX,IAAKT,CAAA,CACN"}